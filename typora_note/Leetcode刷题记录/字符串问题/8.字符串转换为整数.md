<img src="/Users/xuhan/Library/Application Support/typora-user-images/image-20210207081529228.png" alt="image-20210207081529228" style="zoom:33%;" />

​	最核心的一个点：就是这边用long变量在存储临时值的时候，要判断是不是真的越界了。也就是我自己实现的里面的那个IsFlag函数。

```java
class Solution {

public static boolean isReal(String a,int flag)
    {
        long res=0;
        if(flag>0)
        {
            //正数
            for(int i=0;i<a.length();i++)
            {
                int pop=(a.charAt(i)-'0');
                if(res>Integer.MAX_VALUE/10||(res == Integer.MAX_VALUE / 10 && pop > 7))
                {
                    return false;
                }
                res=res*10+pop;
            }
        }else
        {
            for(int i=0;i<a.length();i++)
            {
                int pop=(a.charAt(i)-'0');
                if(res>Integer.MAX_VALUE/10||(res == Integer.MAX_VALUE / 10 && pop > 8))
                {
                    return false;
                }
                res=res*10+pop;
            }
        }
        return true;
    }

    public int myAtoi(String s) {
         s=s.trim();//首先去掉收尾空格
        if(s.equals("")||((s.charAt(0)!='+'&&s.charAt(0)!='-')&&(s.charAt(0)<'0'||s.charAt(0)>'9')))
        {
           return 0;
            // System.out.println(0);
        }

        

        int flag=1;//正数
        StringBuilder sb=new StringBuilder();


        if(s.charAt(0)=='+'&&s.length()>1)
        {
            flag=1;
            s=s.substring(1,s.length());
        }else if(s.charAt(0)=='-'&&s.length()>1)
        {
            flag=-1;
            s=s.substring(1,s.length());
        }else
        {
            flag=1;
        }
        
        // System.out.println(s);
        if(s.charAt(0)<'0'||s.charAt(0)>'9')
        {
            return 0;
        }

        for(int i=0;i<s.length();i++)
        {
            if(s.charAt(i)>='0'&&s.charAt(i)<='9')
            {
                sb.append(s.charAt(i));
            }else
            {
                break;
            }
        }

//        long res=flag*(Integer.parseInt(sb.toString()));
        // System.out.println(sb.toString());

        if(flag>0)
        {
            if(!isReal(sb.toString(),flag))
            {//如果是正数 且大于了最大值
               return Integer.MAX_VALUE;
                // System.out.println(Integer.MAX_VALUE);
            }else
            {
                // System.out.println(Integer.valueOf(sb.toString()));
               return Integer.valueOf(sb.toString());
            }
        }else
        {
            if(!isReal(sb.toString(),flag))
            {//如果是复数 且小于了最小值
               return Integer.MIN_VALUE;
                // System.out.println(Integer.MIN_VALUE);
            }else
            {
                // System.out.println(-Integer.valueOf(sb.toString()));
                if(sb.toString().equals("2147483648"))
                {
                    return Integer.MIN_VALUE;
                }
               return -Integer.valueOf(sb.toString());
            }
        }

    }
}
```

这上面是我最朴素的办法

再看看linweiwei的方法，通过直接遍历去实现：

```java
public class Solution {

    public int myAtoi(String str) {
        int len = str.length();
        // str.charAt(i) 方法回去检查下标的合法性，一般先转换成字符数组
        char[] charArray = str.toCharArray();

        // 1、去除前导空格
        int index = 0;
        while (index < len && charArray[index] == ' ') {
            index++;
        }

        // 2、如果已经遍历完成（针对极端用例 "      "）
        if (index == len) {
            return 0;
        }

        // 3、如果出现符号字符，仅第 1 个有效，并记录正负
        int sign = 1;
        char firstChar = charArray[index];
        if (firstChar == '+') {
            index++;
        } else if (firstChar == '-') {
            index++;
            sign = -1;
        }

        // 4、将后续出现的数字字符进行转换
        // 不能使用 long 类型，这是题目说的
        int res = 0;
        while (index < len) {
            char currChar = charArray[index];
            // 4.1 先判断不合法的情况
            if (currChar > '9' || currChar < '0') {
                break;
            }

            // 题目中说：环境只能存储 32 位大小的有符号整数，因此，需要提前判：断乘以 10 以后是否越界
            if (res > Integer.MAX_VALUE / 10 || (res == Integer.MAX_VALUE / 10 && (currChar - '0') > Integer.MAX_VALUE % 10)) {
                return Integer.MAX_VALUE;
            }
            if (res < Integer.MIN_VALUE / 10 || (res == Integer.MIN_VALUE / 10 && (currChar - '0') > -(Integer.MIN_VALUE % 10))) {
                return Integer.MIN_VALUE;
            }

            // 4.2 合法的情况下，才考虑转换，每一步都把符号位乘进去
            res = res * 10 + sign * (currChar - '0');
            index++;
        }
        return res;
    }

    public static void main(String[] args) {
        Solution solution = new Solution();
        String str = "2147483646";
        int res = solution.myAtoi(str);
        System.out.println(res);

        System.out.println(Integer.MAX_VALUE);
        System.out.println(Integer.MIN_VALUE);
    }
}

作者：liweiwei1419
链接：https://leetcode-cn.com/problems/string-to-integer-atoi/solution/jin-liang-bu-shi-yong-ku-han-shu-nai-xin-diao-shi-/
来源：力扣（LeetCode）
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
```

