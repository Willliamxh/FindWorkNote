# Redis哈希(hash)

redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。

## 基本命令

**A、hset**

语法：hset hash 表的 key field value

作用：将哈希表 key 中的域 field 的值设为 value ，如果 key 不存在，则新建 hash 表，执行赋值，如果有 field ,则覆盖值。

返回值：

①如果 field 是 hash 表中新 field，且设置值成功，返回 1

②如果 field 已经存在，旧值覆盖新值，返回 0

例 1：新的 field

![img](3.2哈希类型hash.assets/1560688781@312f87f0351c399cd2ebfe647f3a841b.png)

例 2：覆盖旧的的

![img](3.2哈希类型hash.assets/1560688813@41f9393131fc839a44743dfcb967dbc9.png)

**B、 hget**

语法：hget key field

作用：获取哈希表 key 中给定域 field 的值

返回值：field 域的值，如果 key 不存在或者 field 不存在返回 nil

例 1：获取存在 key 值的某个域的值

![img](3.2哈希类型hash.assets/1560688867@51cbae79aa20cc41f3146f99ad7eb499.png)

例 2：获取不存在的 field

![img](3.2哈希类型hash.assets/1560688906@4a7d23343c43b992230f34273b8fdd85.png)

**C、 hmset**

语法：hmset key field value [field value…]

说明：同时将多个 field-value (域-值)设置到哈希表 key 中，此命令会覆盖已经存在的 field，hash 表 key 不存在，创建空的 hash 表，执行 hmset.

返回值：设置成功返回 ok， 如果失败返回一个错误

例 1：同时设置多个 field-value

![img](3.2哈希类型hash.assets/1560688966@2a0293c7ac45f1d9a4ae2883837d4375.png)

使用 redis-desktop-manager 工具查看 hash 表 website 的数据结构

![img](3.2哈希类型hash.assets/1560688999@440b107ad34ebf291defe5a91bf90fea.png)

例 2：key 类型不是 hash,产生错误

![img](3.2哈希类型hash.assets/1560689050@4e2fac127881040ff6b5eee41b51062f.png)

**D、hmget**

语法：hmget key field [field…]

作用:获取哈希表 key  中一个或多个给定域的值

返回值：返回和 field 顺序对应的值，如果 field 不存在，返回 nil

例 1：获取多个 field 的值

![img](3.2哈希类型hash.assets/1560689086@429ac2e2e14ebbacaff02f4cc2d412ee.png)

**E、 hgetall**

语法：hgetall key

作用：获取哈希表 key  中所有的域和值

返回值：以列表形式返回 hash 中域和域的值 ，key 不存在，返回空 hash

例 1：返回 key 对应的所有域和值

![img](3.2哈希类型hash.assets/1560689132@4cfcb459a27a07b4bffc43a6e55ef619.png)

例 2：不存在的 key，返回空列表

![img](3.2哈希类型hash.assets/1560689159@7b26976885581dd43900030e6582382f.png)

**F、 hdel**

语法：hdel key field [field…]

作用：删除哈希表 key 中的一个或多个指定域 field，不存在 field 直接忽略返回值：成功删除的 field 的数量

例 1：删除指定的 field

![img](3.2哈希类型hash.assets/1560689200@ba0379743ac2239c7df9d441f74de6e4.png)

## 常用命令

**A、hkeys**

语法：hkeys key

作用：查看哈希表 key 中的所有 field 域

返回值：包含所有 field 的列表，key 不存在返回空列表

例 1：查看 website 所有的域名称

![img](3.2哈希类型hash.assets/1560689261@9508e6e0fcd3553a3b526bbd271bc834.png)

**B、 hvals**

语法：hvals key

作用：返回哈希表 中所有域的值

返回值：包含哈希表所有域值的列表，key 不存在返回空列表

例 1：显示 website 哈希表所有域的值

![img](3.2哈希类型hash.assets/1560689294@2f5abd1a9ce0f9e5cf8ff3ae1a598b3f.png)

**C、 hexists**

语法：hexists key field

作用：查看哈希表 key 中，给定域 field 是否存在返回值：如果 field 存在，返回 1， 其他返回 0

例 1：查看存在 key 中 field 域是否存在

![img](3.2哈希类型hash.assets/1560689333@f53edecf5b2e7ca9d6f4a0ee1de73f43.png)



## 应用场景：



![image-20210322104240035](3.2哈希类型hash.assets/image-20210322104240035.png)

```
 新增商品：hset shopcar:uid 1024 334488 1
 新增商品：hset shopcar:uid 1024 334477 1
 增加商品数量：hincrby shopcar:uid 1024 334477 1
 商品总数：hlen shopcar:uid 1024
 全部选择：hgetall shopcar:uid 1024

```

![在这里插入图片描述](3.2哈希类型hash.assets/20210203145150681.png)